import { useEffect, useRef, useState } from "react"; import { MapContainer, TileLayer, Marker, Popup, useMapEvents } from "react-leaflet"; import L from "leaflet"; import "leaflet/dist/leaflet.css";

const defaultPosition = [20.5937, 78.9629]; // India center

const DishMarker = ({ dish, onClick }) => ( <Marker position={[dish.lat, dish.lng]}> <Popup> <strong>{dish.name}</strong> <br /> {dish.description} </Popup> </Marker> );

const AddDish = ({ onAddDish }) => { const [name, setName] = useState(""); const [description, setDescription] = useState(""); const [latLng, setLatLng] = useState(null); const [dishes, setDishes] = useState([]);

useMapEvents({ click(e) { setLatLng(e.latlng); }, });

const handleAdd = () => { if (name && description && latLng) { const newDish = { name, description, lat: latLng.lat, lng: latLng.lng, }; onAddDish(newDish); setDishes([...dishes, newDish]); setName(""); setDescription(""); setLatLng(null); } };

return ( <div className="flex flex-col gap-2"> <input className="p-2 rounded border" placeholder="Dish Name" value={name} onChange={(e) => setName(e.target.value)} /> <textarea className="p-2 rounded border" placeholder="Dish Description" value={description} onChange={(e) => setDescription(e.target.value)} /> <button
onClick={handleAdd}
className="bg-green-500 text-white py-1 px-3 rounded hover:bg-green-600"
> Add Dish </button> {latLng && ( <p className="text-sm text-gray-500"> Selected location: ({latLng.lat.toFixed(3)}, {latLng.lng.toFixed(3)}) </p> )} </div> ); };

export default function TasteTrekMap() { const [dishes, setDishes] = useState([]); const [panelOpen, setPanelOpen] = useState(true);

const handleAddDish = (dish) => { setDishes([...dishes, dish]); };

return ( <div className="relative w-full h-screen"> <MapContainer center={defaultPosition} zoom={4} className="w-full h-full z-0"> <TileLayer url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png" /> {dishes.map((dish, index) => ( <DishMarker key={index} dish={dish} /> ))} <AddDish onAddDish={handleAddDish} /> </MapContainer>

{/* Toggle Button */}
  <button
    onClick={() => setPanelOpen(!panelOpen)}
    className="absolute bottom-4 left-4 z-10 bg-white p-2 rounded-full shadow hover:bg-gray-200"
  >
    ‚ò∞
  </button>

  {/* Panel */}
  {panelOpen && (
    <div className="absolute top-4 left-4 z-10 bg-white shadow-lg p-4 rounded-xl w-[280px] max-h-[90vh] overflow-y-auto">
      <h2 className="text-xl font-bold mb-2">üçú TasteTrek</h2>
      <p className="text-sm text-gray-600 mb-4">
        Click on the map to select a location and add a dish.
      </p>
      <AddDish onAddDish={handleAddDish} />
    </div>
  )}
</div>

); }

